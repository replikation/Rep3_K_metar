gg<- gg + scale_fill_brewer(palette = "Set1", direction = -1)
gg<- gg + coord_equal()
## add title
gg<- gg + labs(x=NULL, y=NULL, title="Genmap of KPC plasmids")
library(ggthemes)
##starting with a base theme of theme_tufte() from the ggthemes package. It removes alot of chart junk without having to do it manually.
gg <- gg + theme_tufte(base_family="Helvetica")
gg <- gg + theme(axis.ticks=element_blank())
gg <- gg + theme(axis.text.x=element_text(angle = 45, hjust = 1))
gg
# SAMPLEINPUT
mut<- replicate(20, sample(c(0,1,2), 10, replace=TRUE))
mut<- as.data.frame(mut)
colnames(mut)<- paste0("sample", 1:20)
mut<- mut %>% mutate(gene=paste0("gene", 1:10))
head(mut)
#tidy data?
mut.tidy<- mut %>% tidyr::gather(sample, mutated, 1:20)
## change the levels for gene names and sample names so it goes 1,2,3,4... rather than 1, 10...
mut.tidy$gene<- factor(mut.tidy$gene, levels = paste0("gene", 1:10))
mut.tidy$sample<- factor(mut.tidy$sample, levels = paste0("sample", 1:20))
mut.tidy$mutated<- factor(mut.tidy$mutated)
gg <- ggplot(mut.tidy, aes(x=sample, y=gene, fill=mutated)) + geom_tile(color="white", size=0.5)
library(RColorBrewer) ## better color schema
## check all the color pallete and choose one
#display.brewer.all()
# plotting
gg<- gg + scale_fill_brewer(palette = "Set1", direction = -1)
gg<- gg + coord_equal()
## add title
gg<- gg + labs(x=NULL, y=NULL, title="Genmap of KPC plasmids")
library(ggthemes)
##starting with a base theme of theme_tufte() from the ggthemes package. It removes alot of chart junk without having to do it manually.
gg <- gg + theme_tufte(base_family="Helvetica")
gg <- gg + theme(axis.ticks=element_blank())
gg <- gg + theme(axis.text.x=element_text(angle = 45, hjust = 1))
gg
View(mut)
# SAMPLEINPUT
mut<- replicate(20, sample(c(0,1,2), 10, replace=TRUE))
View(mut)
mut<- as.data.frame(mut)
colnames(mut)<- paste0("sample", 1:20)
View(mut)
#tidy data?
mut.tidy<- mut %>% tidyr::gather(sample, mutated, 1:20)
##creating the same file for plots
mut <- read.table("gentest.csv", sep=";", header = TRUE)
set.seed(1)
# SAMPLEINPUT
mut<- replicate(20, sample(c(0,1,2), 10, replace=TRUE))
mut<- as.data.frame(mut)
colnames(mut)<- paste0("sample", 1:20)
mut<- mut %>% mutate(gene=paste0("gene", 1:10))
head(mut)
#tidy data?
mut.tidy2<- mut %>% tidyr::gather(sample, mutated, 1:20)
##creating the same file for plots
mut.tidy <- read.table("gentest.csv", sep=";", header = TRUE)
##creating the same file for plots
mut <- read.table("gentest.csv", sep=";", header = TRUE)
mut2 <- data.frame(mut(gene, as.character), stringsAsFactors=FALSE)
mut2 <- data.frame(lapply(gene, as.character), stringsAsFactors=FALSE)
mut2 <- mut(lapply(gene, as.character), stringsAsFactors=FALSE)
mut
##creating the same file for plots
mut <- read.table("gentest.csv", sep=";", header = TRUE)
i <- sapply(mut, is.factor)
mut[i] <- lapply(mut[i], as.character)
# SAMPLEINPUT
mut<- replicate(20, sample(c(0,1,2), 10, replace=TRUE))
mut<- as.data.frame(mut)
colnames(mut)<- paste0("sample", 1:20)
mut<- mut %>% mutate(gene=paste0("gene", 1:10))
head(mut)
#tidy data?
mut.tidy2<- mut %>% tidyr::gather(sample, mutated, 1:20)
##creating the same file for plots
mut.tidy <- read.table("gentest.csv", sep=";", header = TRUE)
i <- sapply(mut.tidy, is.factor)
mut.tidy[i] <- lapply(mut.tidy[i], as.character)
g <- sapply(mut.tidy, is.integre)
g <- sapply(mut.tidy, is.integer)
mut.tidy[g] <- lapply(mut.tidy[g], as.number)
mut.tidy[g] <- lapply(mut.tidy[g], as.numeric)
## change the levels for gene names and sample names so it goes 1,2,3,4... rather than 1, 10...
mut.tidy$gene<- factor(mut.tidy$gene, levels = paste0("gene", 1:10))
mut.tidy$sample<- factor(mut.tidy$sample, levels = paste0("sample", 1:20))
mut.tidy$mutated<- factor(mut.tidy$mutated)
gg <- ggplot(mut.tidy, aes(x=sample, y=gene, fill=mutated)) + geom_tile(color="white", size=0.5)
library(RColorBrewer) ## better color schema
## check all the color pallete and choose one
#display.brewer.all()
# plotting
gg<- gg + scale_fill_brewer(palette = "Set1", direction = -1)
gg<- gg + coord_equal()
## add title
gg<- gg + labs(x=NULL, y=NULL, title="Genmap of KPC plasmids")
library(ggthemes)
##starting with a base theme of theme_tufte() from the ggthemes package. It removes alot of chart junk without having to do it manually.
gg <- gg + theme_tufte(base_family="Helvetica")
gg <- gg + theme(axis.ticks=element_blank())
gg <- gg + theme(axis.text.x=element_text(angle = 45, hjust = 1))
gg
##creating the same file for plots
mut.tidy <- read.table("gentest.csv", sep=";", header = TRUE)
# to set the columns right
i <- sapply(mut.tidy, is.factor)
mut.tidy[i] <- lapply(mut.tidy[i], as.character)
g <- sapply(mut.tidy, is.integer)
mut.tidy[g] <- lapply(mut.tidy[g], as.numeric)
## change the levels for gene names and sample names so it goes 1,2,3,4... rather than 1, 10...
#mut.tidy$gene<- factor(mut.tidy$gene, levels = paste0("gene", 1:10))
#mut.tidy$sample<- factor(mut.tidy$sample, levels = paste0("sample", 1:20))
#mut.tidy$mutated<- factor(mut.tidy$mutated)
gg <- ggplot(mut.tidy, aes(x=sample, y=gene, fill=mutated)) + geom_tile(color="white", size=0.5)
library(RColorBrewer) ## better color schema
## check all the color pallete and choose one
#display.brewer.all()
# plotting
gg<- gg + scale_fill_brewer(palette = "Set1", direction = -1)
gg<- gg + coord_equal()
## add title
gg<- gg + labs(x=NULL, y=NULL, title="Genmap of KPC plasmids")
library(ggthemes)
##starting with a base theme of theme_tufte() from the ggthemes package. It removes alot of chart junk without having to do it manually.
gg <- gg + theme_tufte(base_family="Helvetica")
gg <- gg + theme(axis.ticks=element_blank())
gg <- gg + theme(axis.text.x=element_text(angle = 45, hjust = 1))
gg
##creating the same file for plots
mut.tidy <- read.table("gentest.csv", sep=";", header = TRUE)
# to set the columns right
i <- sapply(mut.tidy, is.factor)
mut.tidy[i] <- lapply(mut.tidy[i], as.character)
g <- sapply(mut.tidy, is.integer)
mut.tidy[g] <- lapply(mut.tidy[g], as.numeric)
## change the levels for gene names and sample names so it goes 1,2,3,4... rather than 1, 10...
mut.tidy$gene<- factor(mut.tidy$gene, levels = paste0("gene", 1:10))
mut.tidy$sample<- factor(mut.tidy$sample, levels = paste0("sample", 1:20))
mut.tidy$mutated<- factor(mut.tidy$mutated)
gg <- ggplot(mut.tidy, aes(x=sample, y=gene, fill=mutated)) + geom_tile(color="white", size=0.5)
gg
##creating the same file for plots
mut.tidy <- read.table("gentest.csv", sep=";", header = TRUE)
# to set the columns right
i <- sapply(mut.tidy, is.factor)
mut.tidy[i] <- lapply(mut.tidy[i], as.character)
g <- sapply(mut.tidy, is.integer)
mut.tidy[g] <- lapply(mut.tidy[g], as.numeric)
gg <- ggplot(mut.tidy, aes(x=sample, y=gene, fill=mutated)) + geom_tile(color="white", size=0.5)
# SAMPLEINPUT
mut<- replicate(20, sample(c(0,1,2), 10, replace=TRUE))
mut<- as.data.frame(mut)
colnames(mut)<- paste0("sample", 1:20)
mut<- mut %>% mutate(gene=paste0("gene", 1:10))
head(mut)
#tidy data?
mut.tidy2<- mut %>% tidyr::gather(sample, mutated, 1:20)
## change the levels for gene names and sample names so it goes 1,2,3,4... rather than 1, 10...
mut.tidy$gene<- factor(mut.tidy$gene, levels = paste0("gene", 1:10))
mut.tidy$sample<- factor(mut.tidy$sample, levels = paste0("sample", 1:20))
mut.tidy$mutated<- factor(mut.tidy$mutated)
gg <- ggplot(mut.tidy, aes(x=sample, y=gene, fill=mutated)) + geom_tile(color="white", size=0.5)
gg
library(RColorBrewer) ## better color schema
## check all the color pallete and choose one
#display.brewer.all()
# plotting
gg<- gg + scale_fill_brewer(palette = "Set1", direction = -1)
gg<- gg + coord_equal()
## add title
gg<- gg + labs(x=NULL, y=NULL, title="Genmap of KPC plasmids")
library(ggthemes)
##starting with a base theme of theme_tufte() from the ggthemes package. It removes alot of chart junk without having to do it manually.
gg <- gg + theme_tufte(base_family="Helvetica")
#We don’t want any tick marks on the axes and I want the text to be slightly smaller than the default.
gg <- gg + theme(axis.ticks=element_blank())
gg <- gg + theme(axis.text.x=element_text(angle = 45, hjust = 1))
gg
set.seed(1)
#Help here: https://rpubs.com/crazyhottommy/heatmap_demystified
library(dplyr)
library(tidyr)
library(ggplot2)
set.seed(1)
# SAMPLEINPUT
mut<- replicate(20, sample(c(0,1,2), 10, replace=TRUE))
mut<- as.data.frame(mut)
colnames(mut)<- paste0("sample", 1:20)
mut<- mut %>% mutate(gene=paste0("gene", 1:10))
head(mut)
#tidy data?
mut.tidy2<- mut %>% tidyr::gather(sample, mutated, 1:20)
## change the levels for gene names and sample names so it goes 1,2,3,4... rather than 1, 10...
mut.tidy$gene<- factor(mut.tidy$gene, levels = paste0("gene", 1:10))
mut.tidy$sample<- factor(mut.tidy$sample, levels = paste0("sample", 1:20))
mut.tidy$mutated<- factor(mut.tidy$mutated)
gg <- ggplot(mut.tidy, aes(x=sample, y=gene, fill=mutated)) + geom_tile(color="white", size=0.5)
gg
library(RColorBrewer) ## better color schema
## check all the color pallete and choose one
#display.brewer.all()
# plotting
gg<- gg + scale_fill_brewer(palette = "Set1", direction = -1)
gg<- gg + coord_equal()
## add title
gg<- gg + labs(x=NULL, y=NULL, title="Genmap of KPC plasmids")
library(ggthemes)
##starting with a base theme of theme_tufte() from the ggthemes package. It removes alot of chart junk without having to do it manually.
gg <- gg + theme_tufte(base_family="Helvetica")
#We don’t want any tick marks on the axes and I want the text to be slightly smaller than the default.
gg <- gg + theme(axis.ticks=element_blank())
gg <- gg + theme(axis.text.x=element_text(angle = 45, hjust = 1))
gg
#tidy data?
mut.tidy<- mut %>% tidyr::gather(sample, mutated, 1:20)
# SAMPLEINPUT
mut<- replicate(20, sample(c(0,1,2), 10, replace=TRUE))
mut<- as.data.frame(mut)
colnames(mut)<- paste0("sample", 1:20)
mut<- mut %>% mutate(gene=paste0("gene", 1:10))
head(mut)
set.seed(1)
# SAMPLEINPUT
mut<- replicate(20, sample(c(0,1,2), 10, replace=TRUE))
mut<- as.data.frame(mut)
colnames(mut)<- paste0("sample", 1:20)
mut<- mut %>% mutate(gene=paste0("gene", 1:10))
head(mut)
#tidy data?
mut.tidy<- mut %>% tidyr::gather(sample, mutated, 1:20)
## change the levels for gene names and sample names so it goes 1,2,3,4... rather than 1, 10...
mut.tidy$gene<- factor(mut.tidy$gene, levels = paste0("gene", 1:10))
mut.tidy$sample<- factor(mut.tidy$sample, levels = paste0("sample", 1:20))
mut.tidy$mutated<- factor(mut.tidy$mutated)
gg <- ggplot(mut.tidy, aes(x=sample, y=gene, fill=mutated)) + geom_tile(color="white", size=0.5)
gg
library(RColorBrewer) ## better color schema
## check all the color pallete and choose one
#display.brewer.all()
# plotting
gg<- gg + scale_fill_brewer(palette = "Set1", direction = -1)
gg<- gg + coord_equal()
## add title
gg<- gg + labs(x=NULL, y=NULL, title="Genmap of KPC plasmids")
library(ggthemes)
##starting with a base theme of theme_tufte() from the ggthemes package. It removes alot of chart junk without having to do it manually.
gg <- gg + theme_tufte(base_family="Helvetica")
#We don’t want any tick marks on the axes and I want the text to be slightly smaller than the default.
gg <- gg + theme(axis.ticks=element_blank())
gg <- gg + theme(axis.text.x=element_text(angle = 45, hjust = 1))
gg
gg <- ggplot(mut.tidy, aes(y=sample, x=gene, fill=mutated)) + geom_tile(color="white", size=0.5)
gg
library(RColorBrewer) ## better color schema
## check all the color pallete and choose one
#display.brewer.all()
# plotting
gg<- gg + scale_fill_brewer(palette = "Set1", direction = -1)
gg<- gg + coord_equal()
## add title
gg<- gg + labs(x=NULL, y=NULL, title="Genmap of KPC plasmids")
library(ggthemes)
##starting with a base theme of theme_tufte() from the ggthemes package. It removes alot of chart junk without having to do it manually.
gg <- gg + theme_tufte(base_family="Helvetica")
#We don’t want any tick marks on the axes and I want the text to be slightly smaller than the default.
gg <- gg + theme(axis.ticks=element_blank())
gg <- gg + theme(axis.text.x=element_text(angle = 45, hjust = 1))
gg
##creating the same file for plots
mut.tidy <- read.table("gentest.csv", sep=";", header = TRUE)
# to set the columns right
i <- sapply(mut.tidy, is.factor)
mut.tidy[i] <- lapply(mut.tidy[i], as.character)
g <- sapply(mut.tidy, is.integer)
mut.tidy[g] <- lapply(mut.tidy[g], as.numeric)
View(mut.tidy)
View(mut.tidy2)
##creating the same file for plots
mut.tidy <- read.table("gentest.csv", sep=";", header = TRUE)
# to set the columns right
gg <- ggplot(mut.tidy, aes(y=sample, x=gene, fill=mutated)) + geom_tile(color="white", size=0.5)
gg
# to set the columns right
gg <- ggplot(mut.tidy, aes(x=sample, y=gene, fill=mutated)) + geom_tile(color="white", size=0.5)
gg
## check all the color pallete and choose one
#display.brewer.all()
# plotting
gg<- gg + scale_fill_brewer(palette = "Set1", direction = -1)
gg<- gg + coord_equal()
## add title
gg<- gg + labs(x=NULL, y=NULL, title="Genmap of KPC plasmids")
library(ggthemes)
##starting with a base theme of theme_tufte() from the ggthemes package. It removes alot of chart junk without having to do it manually.
gg <- gg + theme_tufte(base_family="Helvetica")
#We don’t want any tick marks on the axes and I want the text to be slightly smaller than the default.
gg <- gg + theme(axis.ticks=element_blank())
gg <- gg + theme(axis.text.x=element_text(angle = 45, hjust = 1))
gg
##creating the same file for plots
mut.tidy <- read.table("gentest.csv", sep=";", header = TRUE)
# to set the columns right
gg <- ggplot(mut.tidy, aes(x=sample, y=gene, fill=mutated)) + geom_tile(color="white", size=0.5)
gg
##creating the same file for plots
mut.tidy <- read.table("gentest.csv", sep=";", header = TRUE)
# plotting
gg <- ggplot(mut.tidy, aes(x=sample, y=gene, fill=mutated)) + geom_tile(color="white", size=0.5)
gg
library(RColorBrewer)
gg<- gg + scale_fill_brewer(palette = "Set1", direction = -1)
gg
# plotting
gg <- ggplot(mut.tidy, aes(x=sample, y=gene, fill=mutated)) + geom_tile(color="white", size=0.5)
gg
gg<- gg + coord_equal()
gg
# plotting
gg <- ggplot(mut.tidy, aes(x=sample, y=gene, fill=mutated)) + geom_tile(color="white", size=0.5)
gg
gg<- gg + coord_equal()
gg<- gg + labs(x=NULL, y=NULL, title="Genmap of KPC plasmids")
gg
##creating the same file for plots
mut.tidy <- read.table("gentest.csv", sep=";", header = TRUE)
# plotting
gg <- ggplot(mut.tidy, aes(x=sample, y=gene, fill=mutated)) + geom_tile(color="white", size=0.5)
gg
library(RColorBrewer)
#gg<- gg + scale_fill_brewer(palette = "Set1", direction = -1)
gg<- gg + coord_equal()
gg<- gg + labs(x=genes, y=plasmidtype, title="Genmap of KPC plasmids")
gg
##creating the same file for plots
mut.tidy <- read.table("gentest.csv", sep=";", header = TRUE)
# plotting
gg <- ggplot(mut.tidy, aes(x=sample, y=gene, fill=mutated)) + geom_tile(color="white", size=0.5)
gg
library(RColorBrewer)
#gg<- gg + scale_fill_brewer(palette = "Set1", direction = -1)
gg<- gg + coord_equal()
gg<- gg + labs(y=genes, x=plasmidtype, title="Genmap of KPC plasmids")
gg
gg <- gg + theme_tufte(base_family="Helvetica")
gg
##creating the same file for plots
mut.tidy <- read.table("gentest.csv", sep=";", header = TRUE)
# plotting
gg <- ggplot(mut.tidy, aes(x=sample, y=gene, fill=mutated)) + geom_tile(color="white", size=0.5)
gg
library(RColorBrewer)
#gg<- gg + scale_fill_brewer(palette = "Set1", direction = -1)
gg<- gg + coord_equal()
gg<- gg + labs(y=genes, x=plasmidtype, title="Genmap of KPC plasmids")
##creating the same file for plots
mut.tidy <- read.table("gentest.csv", sep=";", header = TRUE)
# plotting
gg <- ggplot(mut.tidy, aes(x=sample, y=gene, fill=mutated)) + geom_tile(color="white", size=0.5)
gg
library(RColorBrewer)
#gg<- gg + scale_fill_brewer(palette = "Set1", direction = -1)
gg<- gg + coord_equal()
gg<- gg + labs(y=gene, x=plasmidtype, title="Genmap of KPC plasmids")
gg
gg <- gg + theme_tufte(base_family="Helvetica")
#We don’t want any tick marks on the axes and I want the text to be slightly smaller than the default.
gg <- gg + theme(axis.ticks=element_blank())
gg <- gg + theme(axis.text.x=element_text(angle = 45, hjust = 1))
gg
# plotting
gg <- ggplot(mut.tidy, aes(x=sample, y=gene, fill=mutated)) + geom_tile(color="white", size=0.5)
gg
#gg<- gg + scale_fill_brewer(palette = "Set1", direction = -1)
gg<- gg + coord_equal()
gg<- gg + labs(y=gene, x=plasmidtype, title="Genmap of KPC plasmids")
gg
#gg<- gg + scale_fill_brewer(palette = "Set1", direction = -1)
gg<- gg + coord_equal()
gg<- gg + labs(x=gene, y=plasmidtype, title="Genmap of KPC plasmids")
gg
##creating the same file for plots
mut.tidy <- read.table("gentest.csv", sep=";", header = TRUE)
# plotting
gg <- ggplot(mut.tidy, aes(x=sample, y=gene, fill=mutated)) + geom_tile(color="white", size=0.5)
gg
library(RColorBrewer)
#gg<- gg + scale_fill_brewer(palette = "Set1", direction = -1)
gg<- gg + coord_equal()
gg<- gg + labs(x="gene", y="plasmidtype", title="Genmap of KPC plasmids")
gg
gg<- gg + scale_fill_brewer(palette = "Set1", direction = -1)
gg<- gg + coord_equal()
gg<- gg + labs(x="gene", y="plasmidtype", title="Genmap of KPC plasmids")
gg
##creating the same file for plots
mut.tidy <- read.table("gentest.csv", sep=";", header = TRUE)
# plotting
gg <- ggplot(mut.tidy, aes(x=sample, y=gene, fill=mutated)) + geom_tile(color="white", size=0.5)
gg
library(RColorBrewer)
gg<- gg + scale_fill_brewer(palette = "Set1", direction = -2)
gg<- gg + coord_equal()
gg<- gg + labs(x="gene", y="plasmidtype", title="Genmap of KPC plasmids")
gg
##creating the same file for plots
mut.tidy <- read.table("gentest.csv", sep=";", header = TRUE)
gg <- ggplot(mut.tidy, aes(x=sample, y=gene)) + geom_tile(aes(fill=mutated)color="white", size=0.5)
gg
##creating the same file for plots
mut.tidy <- read.table("gentest.csv", sep=";", header = TRUE)
# plotting
gg <- ggplot(mut.tidy, aes(x=sample, y=gene, fill=mutated)) + geom_tile(color="white", size=0.5)
gg
library(RColorBrewer)
gg<- gg + scale_fill_brewer(palette = "Set1", direction = -1)
gg<- gg + coord_equal()
gg<- gg + labs(x="gene", y="plasmidtype", title="Genmap of KPC plasmids")
gg
gg
##creating the same file for plots
mut.tidy <- read.table("gentest.csv", sep=";", header = TRUE)
# plotting
gg <- ggplot(mut.tidy, aes(x=sample, y=gene, fill=mutated)) + geom_tile(color="white", size=0.5)
gg
library(RColorBrewer)
#gg<- gg + scale_fill_brewer(palette = "Set1", direction = -1)
gg<- gg + coord_equal()
gg<- gg + labs(x="gene", y="plasmidtype", title="Genmap of KPC plasmids")
gg
###-------experiments
##creating the same file for plots
mut.tidy <- read.table("gentest.csv", sep=";", header = TRUE)
g <- sapply(mut.tidy, is.integer)
mut.tidy[g] <- lapply(mut.tidy[g], as.factor)
# plotting
gg <- ggplot(mut.tidy, aes(x=sample, y=gene, fill=mutated)) + geom_tile(color="white", size=0.5)
gg
library(RColorBrewer)
gg<- gg + scale_fill_brewer(palette = "Set1", direction = -1)
gg<- gg + coord_equal()
gg<- gg + labs(x="gene", y="plasmidtype", title="Genmap of KPC plasmids")
gg
gg <- gg + theme_tufte(base_family="Helvetica")
#We don’t want any tick marks on the axes and I want the text to be slightly smaller than the default.
gg <- gg + theme(axis.ticks=element_blank())
gg <- gg + theme(axis.text.x=element_text(angle = 45, hjust = 1))
gg
#We don’t want any tick marks on the axes and I want the text to be slightly smaller than the default.
gg <- gg + theme(axis.ticks=element_blank())
gg <- gg + theme(axis.text.x=element_text(angle = 45, hjust = 1))
gg
display.brewer.all()
#Help here: https://rpubs.com/crazyhottommy/heatmap_demystified
library(dplyr)
library(tidyr)
library(ggplot2)
library(RColorBrewer)
set.seed(1)
###-------experiments
## read table
mut.tidy <- read.table("gentest.csv", sep=";", header = TRUE)
## set heatmap value as factor (so each gets one colour)
g <- sapply(mut.tidy, is.integer)
mut.tidy[g] <- lapply(mut.tidy[g], as.factor)
# plotting
gg <- ggplot(mut.tidy, aes(x=sample, y=gene, fill=mutated)) + geom_tile(color="white", size=0.5)
display.brewer.all() #get setname for next command
gg<- gg + scale_fill_brewer(palette = "Set1", direction = -1)
gg<- gg + coord_equal()
gg<- gg + labs(x="gene", y="plasmidtype", title="Genmap of KPC plasmids")
gg
display.brewer.all() #get setname for next command
###-------experiments
## read table
mut.tidy <- read.table("gentest.csv", sep=";", header = TRUE)
## set heatmap value as factor (so each gets one colour)
g <- sapply(mut.tidy, is.integer)
mut.tidy[g] <- lapply(mut.tidy[g], as.factor)
# plotting
gg <- ggplot(mut.tidy, aes(x=sample, y=gene, fill=mutated)) + geom_tile(color="white", size=0.5)
gg<- gg + coord_equal()
gg<- gg + labs(x="gene", y="plasmidtype", title="Genmap of KPC plasmids")
gg
#Help here: https://rpubs.com/crazyhottommy/heatmap_demystified
library(dplyr)
library(tidyr)
library(ggplot2)
library(RColorBrewer)
library(ggthemes)
set.seed(1)
###-------experiments
## read table
mut.tidy <- read.table("gentest.csv", sep=";", header = TRUE)
## set heatmap value as factor (so each gets one colour)
g <- sapply(mut.tidy, is.integer)
mut.tidy[g] <- lapply(mut.tidy[g], as.factor)
# plotting
gg <- ggplot(mut.tidy, aes(x=sample, y=gene, fill=mutated)) + geom_tile(color="white", size=0.5)
display.brewer.all() #get setname for next command
gg<- gg + scale_fill_brewer(palette = "Set1", direction = -1)
gg<- gg + coord_equal()
gg<- gg + labs(x="gene", y="plasmidtype", title="Genmap of KPC plasmids")
gg
gg <- gg + theme_tufte(base_family="Helvetica")
#We don’t want any tick marks on the axes and I want the text to be slightly smaller than the default.
gg <- gg + theme(axis.ticks=element_blank())
gg <- gg + theme(axis.text.x=element_text(angle = 45, hjust = 1))
gg
gg
library(ggthemes)
